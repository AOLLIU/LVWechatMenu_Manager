<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>微信公众号后台管理平台</title>
    <link rel="stylesheet" href="../css/managerPage.css">
</head>

<body >

<div class="pageContainer" id="app">
    <!--标题-->
    <div class="managerPageHeader">微信公众号后台管理平台</div>

    <!--内容-->
    <div class="managerPageBody">

        <!--左边的界面-->
        <div class="displayInterface">
            <div class="displayInterfaceTitle">{{userName}}</div>
            <div class="displayInterfaceBg">


                <!--主菜单-->
                <ul class="pre_menu_list" >
                    <li class="pre_menu_item" v-for="d in mainMenuList">
                        <a class="pre_menu_link">
                            <span class="menu_item_detail">{{d.menuItemDetailName}}</span>
                        </a>
                    </li>

                    <li class="pre_menu_item menu_item_active" @click="addMenuItemLiClick" id="add_menu_item">
                        <a class="pre_menu_link">
                            <i class="icon14_menu_add"></i>
                            <span class="menu_item_detail">添加菜单</span>
                        </a>
                    </li>
                </ul>

                <!--子菜单-->
                <!--<ul class="sub_menu_list">-->
                <!--<li class="pre_subMenu_item"> -->
                <!--<a class="pre_subMenu_link">-->
                <!--<i class="icon14_menu_add"></i>-->
                <!--<span class="add_subMenu_tip"></span>-->
                <!--</a>-->
                <!--</li>-->
                <!--</ul>-->
                <!---->

            </div>
        </div>



        <!--右边的界面-->
        <div class="portable_editor">
            <!--头部-->
            <div class="portable_header">
                <span class="portable_header_left">菜单名称</span>
                <span class="portable_header_right" @click="deletemenuitemClick">删除菜单</span>
            </div>

            <div class="muneNameDiv">
                <label class="commentLabel">菜单名称</label>
                <input type="text" class="commentInput" id="name" id="commentInput" value="">
                <div class="muneTipDiv">字数不超过4个汉字或8个字母</div>
            </div>

            <!--中间-->
            <div class="muneContentDiv">
                <label class="muneContentTitle">菜单内容</label>
                <div class="start-radio">
                    <input type="radio" value="1" class="radio" name="seletType" checked="true" @change="selectMessageOrUrl('message')">
                    <div class="radioChose">发送消息</div>
                </div>
                <div class="close-radio">
                    <input type="radio" value="0" class="radio" name="seletType" @change="selectMessageOrUrl('url')">
                    <div class="radioChose">跳转网页</div>
                </div>
            </div>

            <!--内容-->

            <!--1.发送消息-->
            <div class="concreteInnerMessageDiv">
                <!--1.1标题-->
                <div class="concreteInnerMessageTitleDiv">
                    <span class="concreteInnerMessageTitle">消息</span>
                </div>

                <!--1.2消息内容-->
                <div class="concreteInnerMessageContent" @click="alertPickerContentPage">
                    <div>
                        <img src="../source/Snip20161212_9.png" class="PickerContentImage">
                    </div>
                    <a class="PickerContentButton">从素材库中选择</a>
                </div>
            </div>


            <!--2网页-->
            <div class="concreteInnerURLDiv" style="display: none">
                <!--2.1标题-->
                <div class="concreteInnerURLTitle">订阅者点击该子菜单会跳到以下链接</div>
                <!--2.2连接-->
                <div class="concreteInnerURLContent">
                    <label class="concreteInnerURLLabel">网页地址</label>
                    <input type="text" class="concreteInnerURLInput" placeholder="请输入要跳转的地址">
                </div>
            </div>

        </div>

        <!--底部按钮-->
        <div class="bottomBtnDiv" @click="saveAndPublishBtnClick">
            <a class="saveAndPublishBtn" @click="">保存并发布</a>
        </div>

    </div>

    <!--尾部-->
    <div class="managerPageFooter">
        byAOLLIU
    </div>


</div>

<script src="../third/jquery.min.js"></script>
<script src="../third/vue.min.js"></script>
<script src="../js/alertWindow.js"></script>
<script>


    $(function () {

    });

    var appData = {
        userName:"",
        mainMenuList:[],
    };

    //1.添加主菜单
    function addMenuItemLiClick() {
        var menu = {"menuItemDetailName":"菜单名称"}
        appData.mainMenuList.push(menu)
        changeMenuWidth()
    }






    var appFunc = {

        //删除菜单
        deletemenuitemClick:function () {

            //弹框提示
            myAlertWindow.initial("温馨提示","删除后该菜单下设置的所有内容将被删除")

            //点击了确认按钮
            myAlertWindow.conformBtnClick(function () {

            })
        },

        //切换发送消息还是跳转url
        selectMessageOrUrl:function (e) {
            if (e == "message"){
                $(".concreteInnerMessageDiv").show()
                $(".concreteInnerURLDiv").hide()
            }else {
                $(".concreteInnerMessageDiv").hide()
                $(".concreteInnerURLDiv").show()
            }
        },

        //选择图文消息
        alertPickerContentPage:function () {
            alert("弹框")
        },

        //点击保存
        saveAndPublishBtnClick:function () {
            alert("保存设置")
        }
    };

    var appVue = new Vue({
        el: "#app",
        data: appData,
        methods: {
            addmenuitemOrSwitchMenuClick:appFunc.addmenuitemOrSwitchMenuClick,

            deletemenuitemClick:appFunc.deletemenuitemClick,
            selectMessageOrUrl:appFunc.selectMessageOrUrl,
            alertPickerContentPage:appFunc.alertPickerContentPage,
            saveAndPublishBtnClick:appFunc.saveAndPublishBtnClick,
        },
        mounted:function () {
            getInitialData();
            addRightPortableEditorInputChange()
        }
    });

    function getInitialData() {
        appData.userName = "AOLIU的每一天"
        var arr1 = [
        ]
        appData.mainMenuList = arr1
        changeMenuWidth()
    }

    //调整menu的宽度
    function changeMenuWidth() {
        //计算当前有多少个li
        var listCount = $(".pre_menu_list").children("li").length
        var itemTotalWidth = $('.pre_menu_list').width()

        alert(listCount)
        if (listCount == 1){//如果是1,就是添加按钮,为选中状态
            $(".pre_menu_item li").width(itemTotalWidth - 2)
            $("#add_menu_item").addClass("menu_item_active")
        }else if( 1< listCount < 4){
            $(".pre_menu_item").addClass("menu_item_active")
            $(".pre_menu_item li").width((itemTotalWidth - (2 * listCount)) / listCount)
        }

    }

    //监听右侧输入框文字的改变
    function addRightPortableEditorInputChange() {

        $('.commentInput').on('input propertychange', function() {
            var newmenuName = $(this).val();

            if (newmenuName.length == 0){
//                $(".menu_item_active").find(".js_addMenuTips").first().text("")
            }else {
                $(".menu_item_active").find(".js_addMenuTips").first().text(newmenuName)
            }
        });

    }

</script>
</body>
</html>